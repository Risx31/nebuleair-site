<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Succ√®s & Bonus NebuleSnake</title>
  <style>
    :root {
      --bg: #020617;
      --panel-bg: #020617;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.18);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --shadow-soft: 0 25px 60px rgba(0, 0, 0, 0.7);
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #0b1120 0, #020617 55%, #020617 100%);
      color: var(--text);
      padding: 24px 16px 32px;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--muted);
      text-decoration: none;
      margin-bottom: 12px;
    }
    .back-link:hover {
      color: var(--text);
    }

    .back-link span:first-child {
      font-size: 18px;
    }

    .panel {
      background: radial-gradient(circle at top left, #020617 0, #020617 65%);
      border-radius: 24px;
      border: 1px solid rgba(30, 64, 175, 0.6);
      box-shadow: var(--shadow-soft);
      padding: 20px 22px 22px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .panel-title {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .panel-title span {
      color: var(--accent);
      margin-left: 6px;
    }

    .panel-subtitle {
      font-size: 13px;
      color: var(--muted);
    }

    .panel-intro {
      font-size: 13px;
      line-height: 1.5;
      color: var(--muted);
      margin-bottom: 10px;
    }

    /* Stats globales */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin: 4px 0 14px;
    }

    .stats-card {
      background: radial-gradient(circle at top left, #0b1120 0, #020617 75%);
      border-radius: 14px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      padding: 8px 10px 9px;
    }

    .stats-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .stats-value {
      font-size: 18px;
      font-weight: 650;
      color: #e5e7eb;
    }

    /* Sections */
    .section-title {
      font-size: 16px;
      font-weight: 650;
      margin: 18px 0 6px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #cbd5f5;
    }

    .section-sub {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .achievements-list {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .achievement-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 8px 10px 9px;
    }

    .achievement-title {
      font-size: 13px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .achievement-title span.emoji {
      font-size: 15px;
    }

    .achievement-subtitle {
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 3px;
    }

    .achievement-text {
      font-size: 12px;
      line-height: 1.4;
      color: #e5e7eb;
    }

    .bonus-list {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 6px;
    }

    .bonus-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 8px 10px 9px;
      font-size: 12px;
    }

    .bonus-title {
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      margin-bottom: 3px;
    }

    .bonus-title span.emoji {
      font-size: 15px;
    }

    .bonus-text {
      color: #e5e7eb;
      line-height: 1.4;
    }

    .rarity {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    @media (max-width: 720px) {
      .achievements-list,
      .bonus-list,
      .stats-bar {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <a href="dashboard.html" class="back-link">
      <span>‚Üê</span>
      <span>Retour au dashboard</span>
    </a>

    <div class="panel">
      <div class="panel-header">
        <div>
          <div class="panel-title">
            Succ√®s & Bonus <span>NebuleSnake</span>
          </div>
          <div class="panel-subtitle">
            Pour les vrais tryharders de la pollution üêç
          </div>
        </div>
      </div>

      <p class="panel-intro">
        Chaque succ√®s est v√©rifi√© √† la fin d‚Äôune partie. Quand tu le d√©bloques,
        un petit badge s‚Äôaffiche √† c√¥t√© de ton score dans le classement mondial.
        Cette page affiche aussi les stats <strong>globales</strong> de tous les joueurs.
      </p>

      <!-- Stats globales -->
      <div class="stats-bar">
        <div class="stats-card">
          <div class="stats-label">Parties jou√©es (global)</div>
          <div class="stats-value">
            <span id="stats-total-games">0</span>
          </div>
        </div>
        <div class="stats-card">
          <div class="stats-label">Temps total de jeu (global)</div>
          <div class="stats-value">
            <span id="stats-total-time">0 s</span>
          </div>
        </div>
      </div>

      <!-- Succ√®s de run -->
      <h2 class="section-title">Succ√®s de run</h2>
      <p class="section-sub">
        Succ√®s check√©s sur une seule partie.
      </p>

      <div class="achievements-list">
        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">‚ö°</span>
            <span>PERMA-TURBO</span>
          </div>
          <div class="achievement-subtitle">Rester sous st√©ro√Ødes.</div>
          <div class="achievement-text">
            Rester en turbo au moins la moiti√© de la partie, avec
            <strong>turbo actif ‚â• 50&nbsp;% du temps de jeu</strong> et
            <strong>score ‚â• 40</strong>.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">üé∞</span>
            <span>GAMBLER</span>
          </div>
          <div class="achievement-subtitle">Build full casino.</div>
          <div class="achievement-text">
            Prendre au moins <strong>1 Jackpot üí∞</strong> et
            <strong>2 Double ‚ú®</strong>, ne jamais prendre Minceur ‚úÇÔ∏è
            et finir avec un <strong>score ‚â• 50</strong>.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">üèãÔ∏è</span>
            <span>YOYO BODY</span>
          </div>
          <div class="achievement-subtitle">Jouer avec ta propre masse.</div>
          <div class="achievement-text">
            Atteindre une <strong>longueur ‚â• 25</strong>, puis reperdre au moins
            <strong>8 cases</strong> dans la m√™me partie.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">üèÉ‚Äç‚ôÇÔ∏è</span>
            <span>APPLE RUSH</span>
          </div>
          <div class="achievement-subtitle">Sprint sous turbo.</div>
          <div class="achievement-text">
            Sous turbo actif, manger au moins
            <strong>10 pommes</strong> pendant qu‚Äôun bonus turbo est encore en cours.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">‚õàÔ∏è</span>
            <span>STORM RIDER</span>
          </div>
          <div class="achievement-subtitle">Survivre √† la pluie de dor√©es.</div>
          <div class="achievement-text">
            Manger <strong>‚â• 3 pommes dor√©es üçè</strong> dans une seule partie,
            avec <strong>score ‚â• 70</strong> et <strong>longueur max ‚â• 25</strong>.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">üß±</span>
            <span>FULL HOUSE</span>
          </div>
          <div class="achievement-subtitle">Tout utiliser dans le m√™me run.</div>
          <div class="achievement-text">
            Utiliser au moins <strong>1 fois chaque bonus</strong> (‚ö° ‚ú® üí∞ ‚úÇÔ∏è)
            et manger <strong>‚â• 2 pommes dor√©es üçè</strong> avec un
            <strong>score ‚â• 80</strong>.
          </div>
        </div>

        <div class="achievement-card">
          <div class="achievement-title">
            <span class="emoji">üèÉ‚Äç‚ôÄÔ∏è</span>
            <span>MARATHON RUN</span>
          </div>
          <div class="achievement-subtitle">Tenir la distance.</div>
          <div class="achievement-text">
            Survivre <strong>‚â• 3 minutes</strong> dans une seule partie, avec
            un <strong>score ‚â• 100</strong>.
          </div>
        </div>
      </div>

      <!-- Bonus & pommes -->
      <h2 class="section-title">Bonus & pommes sp√©ciales</h2>
      <p class="section-sub">
        Petit r√©sum√© des bonus qui apparaissent sur la grille, avec leurs effets et leur raret√©.
      </p>

      <div class="bonus-list">
        <div class="bonus-card">
          <div class="bonus-title">
            <span class="emoji">‚ö°</span>
            <span>Turbo contr√¥l√©</span>
          </div>
          <div class="bonus-text">
            Acc√©l√®re fortement le serpent pendant <strong>5 secondes</strong> et
            ajoute <strong>+1 point</strong> par pomme mang√©e.
          </div>
          <div class="rarity">Raret√© : ~2&nbsp;% apr√®s chaque pomme mang√©e.</div>
        </div>

        <div class="bonus-card">
          <div class="bonus-title">
            <span class="emoji">‚ú®</span>
            <span>Double Score</span>
          </div>
          <div class="bonus-text">
            Toutes les pommes rapportent <strong>√ó2 points</strong> pendant
            <strong>10 secondes</strong>.
          </div>
          <div class="rarity">Raret√© : ~3&nbsp;%.</div>
        </div>

        <div class="bonus-card">
          <div class="bonus-title">
            <span class="emoji">üí∞</span>
            <span>Jackpot</span>
          </div>
          <div class="bonus-text">
            Donne directement <strong>+5 points</strong> quand tu le manges.
          </div>
          <div class="rarity">Raret√© : ~4&nbsp;%.</div>
        </div>

        <div class="bonus-card">
          <div class="bonus-title">
            <span class="emoji">‚úÇÔ∏è</span>
            <span>Minceur express</span>
          </div>
          <div class="bonus-text">
            Coupe une partie de ta queue (jusqu‚Äô√† 4 segments), pratique pour
            se sortir d‚Äôun coin un peu trop serr√©.
          </div>
          <div class="rarity">Raret√© : ~5&nbsp;%.</div>
        </div>

        <div class="bonus-card">
          <div class="bonus-title">
            <span class="emoji">üçè</span>
            <span>Pomme dor√©e</span>
          </div>
          <div class="bonus-text">
            Pomme sp√©ciale qui, une fois mang√©e, fait appara√Ætre
            <strong>5 pommes normales</strong> d‚Äôun coup sur la grille.
          </div>
          <div class="rarity">Raret√© : ~1&nbsp;% apr√®s une pomme mang√©e.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const LEADERBOARD_API_URL =
        "https://nebuleairproxy.onrender.com/snake/leaderboard";

      function formatDuration(sec) {
        sec = Math.max(0, Math.floor(Number(sec) || 0));
        const h = Math.floor(sec / 3600);
        const m = Math.floor((sec % 3600) / 60);
        const s = sec % 60;
        const parts = [];
        if (h > 0) parts.push(h + " h");
        if (m > 0 || h > 0) parts.push(m + " min");
        parts.push(s + " s");
        return parts.join(" ");
      }

      async function loadGlobalStats() {
        const gamesEl = document.getElementById("stats-total-games");
        const timeEl = document.getElementById("stats-total-time");
        if (!gamesEl || !timeEl) return;

        try {
          const res = await fetch(LEADERBOARD_API_URL);
          if (!res.ok) throw new Error("HTTP " + res.status);
          const data = await res.json();
          const stats = data.globalStats || {
            totalGames: 0,
            totalPlayTimeSec: 0
          };

          gamesEl.textContent = stats.totalGames ?? 0;
          timeEl.textContent = formatDuration(stats.totalPlayTimeSec ?? 0);
        } catch (e) {
          console.warn("[Succ√®s] Impossible de charger les stats globales", e);
          gamesEl.textContent = "‚Äî";
          timeEl.textContent = "‚Äî";
        }
      }

      document.addEventListener("DOMContentLoaded", loadGlobalStats);
    })();
  </script>
</body>
</html>
